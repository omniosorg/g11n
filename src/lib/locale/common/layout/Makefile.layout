#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").  
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
# Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#

LAYOUT_VERSION=1

PWD:sh=pwd

LD_OPTIONS=-R/usr/ccs/lib:/usr/lib:/usr/dt/lib:/usr/openwin/lib

SRCDIR= $(SRC)/src/lib/locale/common/layout

CCSRCS=LOtypes.c LOchar.c  LOseg.c LOline.c LOresolve.c LOcontrol.c 

HEADERS=$(CCSRCS:%.c=%.H) LOexception.H CTLfunctions.H LOdefs.H $(LOCALE)_data.h

ALL_SRC=$(CCSRCS) $(HEADERS) layout.h layout_int.h$(LOCALE)_data.h

CFLAGS= -G -z text -H -KPIC -DNeedFunctionPrototypes -I.

LDFLAGS= -Bdynamic -z defs -z text -G -lc -lCrun -norunpath 

CFLAGS_sparc=-xregs=no%appl
CFLAGS_sparcv9=-xregs=no%appl -xarch=v9 -dalign
CFLAGS_amd64=-xarch=generic64 -Ui386 -U__i386 -Qoption ccfe -y-a

LDFLAGS_sparcv9=-xarch=v9
LDFLAGS_amd64=-xarch=amd64 -norunpath

OBJS=$(CCSRCS:%.c=%.o)
OBJS64=$(CCSRCS:%.c=$(MACH64)/%.o)

%.o:$(SRCDIR)/%.C
	$(CCC)  $(CFLAGS) $(CFLAGS_$(MACH)) $(TARGET_FLAGS) -c -o $@ $<

$(MACH64)/%.o:$(SRCDIR)/%.C
	$(CCC)  $(CFLAGS) $(CFLAGS_$(MACH64))  $(TARGET_FLAGS) -c -o  $@ $<

$(LAYOUT_SO): $(OBJS)
	$(CCC) $(CFLAGS) $(CFLAGS_$(MACH)) $(LDFLAGS)  -o  $@ $(OBJS)

$(LAYOUT64_SO): $(OBJS64)
	$(CCC) $(CFLAGS) $(CFLAGS_$(MACH64)) $(LDFLAGS) $(LDFLAGS_$(MACH64)) -o $@ $(OBJS64)

all: $(MACH64) $(LAYOUT_SO) $(LAYOUT64_SO)

$(MACH64):
	$(INSDIR) $(MACH64)

clean:
	$(RM) *.o *.so.$(LAYOUT_VERSION)
	$(RM)  -r $(MACH64) 
	$(RM) -r $(TARGETDIR)

FRC:
